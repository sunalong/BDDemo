//数据样例如下：每个表一条数据

//{
//  "dbName": "dim",
//  "tableList": [{
//    "tableName": "dim_shop",
//    "columns": [
//      {"fieldsName": "dim_shop_id","type": "string","Comment": "门店ID"},
//      {"fieldsName": "shop_code","type": "string","Comment": "门店编码"}
//    ]
//  },
//    {
//      "tableName": "dim_category",
//      "columns": [
//        {"fieldsName": "dim_category_id","type": "string","Comment": "品类id"},
//        {"fieldsName": "category_code","type": "string","Comment": "品类编码"}
//      ]
//    }
//  ]
//}


{"dbName": "dim", "tableList": [
  {"tableName": "dim_shop","columns": [
      {"fieldsName": "dim_shop_id","type": "string","Comment": "门店ID"},
      {"fieldsName": "dim_shop_id","type": "string","Comment": "门店ID"},
      {"fieldsName": "dim_shop_id","type": "string","Comment": "门店ID"},
      {"fieldsName": "dim_shop_id","type": "string","Comment": "门店ID"},
      {"fieldsName": "shop_code","type": "string","Comment": "门店编码"}]},
  {"tableName": "dim_category","columns": [
      {"fieldsName": "dim_category_id","type": "string","Comment": "品类id"},
      {"fieldsName": "category_code","type": "string","Comment": "品类编码"}]}]
}

//一：生成数据集
//注意非空值的判断
//create table test.subdata as
//SELECT  a.DB_ID,a.NAME
//,b.TBL_ID,b.TBL_TYPE,b.TBL_NAME
//,c.CD_ID
//,COALESCE(d.COMMENT,'') as COMMENT,d.COLUMN_NAME,d.TYPE_NAME,d.INTEGER_IDX
//from hive.DBS as a
//left join (SELECT TBL_ID,DB_ID,SD_ID,TBL_TYPE,TBL_NAME
//from hive.TBLS
//) as b on b.DB_ID = a.DB_ID
//left join (
//SELECT SD_ID,CD_ID
//from hive.SDS
//)as c on c.SD_ID = b.SD_ID
//left join (
//SELECT CD_ID,COMMENT,COLUMN_NAME,TYPE_NAME,INTEGER_IDX
//from hive.COLUMNS_V2
//)as d on d.CD_ID = c.CD_ID
//WHERE b.TBL_NAME in('dim_shop','dim_category')
//--  and a.DB_ID = 2984
//order by a.DB_ID,b.TBL_ID,c.CD_ID,d.INTEGER_IDX
//-- limit 100
//
//drop table test.subdata

//二：拼接字符串
//select DB_ID,TBL_ID, TBL_TYPE, INTEGER_IDX
//, CONCAT("\"dbName\": \"",NAME,"\", \"tableList\": [{") as db_head
//, CONCAT("\"tabName\": \"",TBL_NAME,"\",\"columns\": [") as tab_head
//, CONCAT("{\"fieldsName\": \"",COLUMN_NAME,"\",\"type\": \"",TYPE_NAME,"\",\"Comment\": \"",COMMENT,"\"},") as col_head
//from test.subdata




//{
//  "tableName": "dim_shop",
//  "fieldsType": {
//    "dim_shop_id": "string",
//    "shop_code": "string",
//    "branch_code": "string",
//    "branch_name": "string"
//  },
//  "fieldsComment": {
//    "dim_shop_id": "门店ID",
//    "shop_code": "门店编码",
//    "branch_code": "分公司编码",
//    "branch_name": "分公司名称"
//  }
//}
